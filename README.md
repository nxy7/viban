# Viban

A fast-iteration task management tool inspired by [Vibe Kanban](https://vibekanban.com).

The main motivation for this project is the belief that a different tech stack can enable much faster iteration speed for development.

## Quick Start

### Prerequisites

| Tool | Required | Installation |
|------|----------|--------------|
| Docker | **Yes** | [Get Docker](https://docs.docker.com/get-docker/) |
| Node.js | For npx install | [Get Node.js](https://nodejs.org/) |

### Install & Run

```bash
npx @nxy7/viban
```

That's it! Viban will:
1. Download the appropriate binary for your platform
2. Start a PostgreSQL container automatically
3. Open your browser to the app

> **Note**: Viban uses HTTPS with a self-signed certificate for HTTP/2 support. Your browser may show a security warning on first visit - this is expected. Click "Advanced" → "Proceed" to continue.

### Alternative: Direct Binary Download

You can also download the binary directly from [GitHub Releases](https://github.com/nxy7/viban/releases):

```bash
# macOS (Apple Silicon)
curl -L https://github.com/nxy7/viban/releases/latest/download/viban-macos_arm -o viban
chmod +x viban
./viban

# Linux (x64)
curl -L https://github.com/nxy7/viban/releases/latest/download/viban-linux_intel -o viban
chmod +x viban
./viban
```

## Requirements

### Core Requirements

| Tool | Required | Purpose |
|------|----------|---------|
| Docker | **Yes** | PostgreSQL database (auto-managed) |
| Git | **Yes** | Version control, worktree management |
| OpenSSL | **Yes** | SSL certificate generation for HTTPS |

### Optional Tools

Viban detects available tools at startup and enables features accordingly. Check **Board Settings > System** to see detected tools.

| Tool | Purpose | Feature Enabled |
|------|---------|-----------------|
| `gh` (GitHub CLI) | GitHub integration | Pull Request creation, PR status sync |
| `claude` (Claude Code) | AI-powered task execution | Claude Code executor |
| `codex` (OpenAI Codex) | AI-powered task execution | Codex executor |
| `aider` | AI-powered coding assistant | Aider executor |
| `goose` | AI-powered coding assistant | Goose executor |

### Installing Optional Tools

**GitHub CLI** (for PR functionality):
```bash
# macOS
brew install gh
gh auth login

# Linux
curl -fsSL https://cli.github.com/packages/githubcli-archive-keyring.gpg | sudo dd of=/usr/share/keyrings/githubcli-archive-keyring.gpg
echo "deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/githubcli-archive-keyring.gpg] https://cli.github.com/packages stable main" | sudo tee /etc/apt/sources.list.d/github-cli.list > /dev/null
sudo apt update && sudo apt install gh
```

**Claude Code** (for Claude AI executor):
```bash
npm install -g @anthropic-ai/claude-code
```

**Aider** (for Aider executor):
```bash
pip install aider-chat
```

---

## Development

This section covers running the project locally for development.

### Tech Stack

- **Backend**: Elixir + Ash Framework + AshSync
- **Database**: PostgreSQL
- **Frontend**: SolidJS + TanStack DB + Bun
- **Real-time**: Electric SQL (via AshSync codegen)

### Prerequisites

- [Nix](https://nixos.org/download.html) with flakes enabled (recommended)
- Or manually: Docker, Elixir 1.17+, Bun

### Running the Project

```bash
# Enter the dev shell (installs all dependencies via Nix)
nix develop

# Start everything with one command
just dev
```

This uses [overmind](https://github.com/DarthSim/overmind) to run all services:
- Docker Compose (PostgreSQL)
- Backend (Elixir/Phoenix with HTTPS on port 8000)
- Frontend (SolidJS dev server on port 3000, proxied through Phoenix)

The app will be available at:
- **Application**: https://localhost:8000

#### Manual Setup (without Nix)

```bash
# Start the database
docker compose up -d db

# In one terminal - backend
cd backend && mix deps.get && mix ash.setup && mix phx.server

# In another terminal - frontend
cd frontend && bun i && bun dev
```

### Project Structure

```
viban/
├── backend/           # Elixir/Ash/Phoenix backend
│   ├── lib/
│   │   ├── viban/           # Core domain (Ash resources)
│   │   └── viban_web/       # Phoenix web layer
│   ├── config/              # Configuration
│   └── priv/                # Migrations, static assets
├── frontend/          # SolidJS frontend
│   ├── src/
│   │   ├── lib/
│   │   │   ├── generated/sync/  # Auto-generated by AshSync
│   │   │   └── useKanban.ts     # Re-exports and custom hooks
│   │   └── routes/          # Page routes
│   └── package.json
├── Procfile.dev       # Overmind process definitions
├── justfile           # Development commands
├── docker-compose.yml # Development services
└── flake.nix          # Nix dev environment
```

### Development Commands

```bash
just              # Show all available commands
just dev          # Start all services with overmind
just stop         # Stop all overmind processes
just restart db   # Restart a specific process

just backend      # Start only backend
just frontend     # Start only frontend
just db           # Start only database

just test-backend # Run backend tests
just test-e2e     # Run Playwright e2e tests

just migrate name # Generate a new Ash migration
just db-reset     # Reset database
just clean        # Clean all build artifacts
just fmt          # Format all code
```

### Overmind Tips

```bash
# Connect to a process log
just connect backend

# Restart a specific service
just restart frontend

# Stop everything
just stop
```

### Architecture

This project uses:

- **Ash Framework** for declarative domain modeling and API generation
- **AshSync** for Electric SQL integration - generates TypeScript collections, Zod schemas, and query functions from Ash resource definitions
- **TanStack DB** with Electric SQL collections for real-time sync to the frontend
- **SolidJS** for a reactive, performant frontend
- **Bun** for fast frontend tooling

#### Real-time Sync with AshSync

AshSync bridges Ash resources to Electric SQL shapes. Define sync queries in your Ash domain:

```elixir
defmodule Viban.Kanban do
  use Ash.Domain, extensions: [AshSync]

  ash_sync do
    resource Viban.Kanban.Board do
      query :sync_boards, :read
    end
  end
end
```

Run `mix ash.codegen` to generate TypeScript files in `frontend/src/lib/generated/sync/`:
- `schema.ts` - Zod schemas and TypeScript types for each resource
- `collections.ts` - TanStack DB collections with Electric SQL shapes
- `queries.ts` - Direct shape query functions

The frontend uses these generated collections via `useLiveQuery` for reactive, real-time data.

## License

Polyform Noncommercial License 1.0.0
